package Controller;

import java.sql.Connection;
import java.sql.DriverManager;

import org.apache.ibatis.session.SqlSession;
import org.apache.ibatis.session.SqlSessionFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.RequestMapping;

import lombok.RequiredArgsConstructor;

@Controller
@RequiredArgsConstructor
public class MainController {
	@Autowired
    private SqlSession sqlSession;
	

    @RequestMapping("/main.do")
    public String main(Model model) {
    	System.out.println("main");
    	try {
            // 간단한 쿼리 실행해보기 (PostgreSQL의 버전 확인)
            String dbVersion = sqlSession.selectOne("test.getVersion");
            System.out.println("DB 연결 성공! 버전: " + dbVersion);
            model.addAttribute("message", "DB 연결 성공! 버전: " + dbVersion);
        } catch (Exception e) {
            System.out.println("DB 연결 성공! 버전: " + dbVersion);
            model.addAttribute("message", "DB 연결 실패: " + e.getMessage());
            e.printStackTrace();
        }
    	
        return "main";
    }
}
